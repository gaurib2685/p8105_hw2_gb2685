---
title: "Homework 2"
author: Gauri Bhatkhande 
output: github_document
editor_options: 
  chunk_output_type: console
---


```{r setup}
library(tidyverse)
library(readxl)
library(dplyr)
```

## Problem 1 

Read the Mr. Trashwheel dataset 
```{r}
trashwheel_df = 
  read_xlsx("./Data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
            sheet = "Mr. Trash Wheel",
            range = cell_cols("A:N")) %>%
  janitor::clean_names() %>%
drop_na(dumpster)%>%
  mutate(
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls)
  )
```

Read precipitation data for 2018 and 2017
```{r}
precip_2018 = 
  read_excel(
    "./Data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2018 Precipitation",
    skip = 1
  ) %>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2018) %>%
  relocate(year)
  
precip_2017 = 
  read_excel(
    "./Data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "2017 Precipitation",
    skip = 1
  ) %>%
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2017) %>%
  relocate(year)
```

Now combine annual precipitation

```{r}
month_df = 
  tibble(
    month = 1:12,
    month_name = month.name
  )

precip_df =
  bind_rows(precip_2018, precip_2017)
  

left_join(precip_df, month_df, by = "month")
```

This dataset contains information from the Mr. Trashwheel trash collector in Balitimore, Maryland. The dataset contains information on year, month, trash collected, specific kinds of trash. There are total `r nrow(trashwheel_df)` rows. Additional data sheets include month precipitation data. 

## Problem 2 

Reading the NYC Transit data from the csv and cleaning it : 
```{r}
nyc_transit_df =
  read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
  janitor::clean_names() %>%
  select(division:route11, entry, vending, entrance_type, ada)

# Converting the entry variable from character to logical  (TRUE, FALSE)
nyc_transit_df$entry =
  ifelse(nyc_transit_df$entry=="YES",TRUE,FALSE )
```

### Short note on the dataset

The given dataset contains the variables: *`r variable.names(nyc_transit_df)`*. So far, I imported the data and read the data from the csv file usinf read_csv function. After that, using the pipe operator I went on to clean the dataset which converted the variable names to lower snake case. For this purpose, I used a function (clean_names) without loading the entire package (janitor). After this, I selected the required column names specified in the homework question using the select function and then selecting the variables in the specified order. In the next step, I converted the entry variable from character to logical  (TRUE, FALSE) using the ifelse function wherein I change the entry variable from nyc_transit_df dataset and assign TRUE for the values that earlier said "yes" and else FALSE. 

The dataset now has `r nrow(nyc_transit_df)` rows and `r ncol(nyc_transit_df)` columns. 

**Finding number of distinct stations**

```{r}
count(distinct(nyc_transit_df, paste(nyc_transit_df$line, nyc_transit_df$station_name)))
```
*The number of distinct stations are 465.*

**Finding how many stations are ADA compliant**

```{r}

ada_compliant_station = 
  filter(nyc_transit_df, ada==TRUE) %>%
  distinct(paste(line, station_name)) %>%
   count()

```
*84 stations are ADA compliant.*

**Finding proportion of station entrances / exits without vending allow entrance**

```{r}
total_entry =
  filter(nyc_transit_df, vending=='NO') %>%
  count()

tot_entry_allowed = 
  filter(nyc_transit_df, vending=='NO') %>%
  filter( entry==TRUE) %>%
  count()


proportion = tot_entry_allowed/total_entry

proportion
```
*The proportion of station entrances / exits without vending that allow entrance is 0.37705 or 37.705%*

**Reformat data so that route number and route name are distinct variables** 

```{r}
nyc_transit_df = mutate(nyc_transit_df,
       route8 = as.character(route8)) %>%
mutate(route9 = as.character(route9)) %>%
mutate(route10 = as.character(route10)) %>%
mutate(route11 = as.character(route11))

nyc_transit_df =
 pivot_longer(
    nyc_transit_df, 
    route1:route11,
    names_to = "route_number", 
    values_to = "route_names")
```

**Finding many distinct stations serve the A train**

```{r}
stations_serve_A = 
  filter(nyc_transit_df, route_names=="A") %>%
  distinct(paste(line, station_name)) %>%
   count()
```
*60 distinct stations serve the A train.*

**Finding how many of the stations that serve the A train are ADA compliant?**

```{r}
stations_serve_A = 
  filter(nyc_transit_df, route_names=="A") %>%
  filter(ada == "TRUE") %>%
  distinct(paste(line, station_name)) %>%
   count()
```

*17 stations that serve the A train are ADA compliant.* 


## Problem 3

**Read data in csv, clean and separate variable mon into integer variables**

```{r}
pols_df =
  read_csv(file = "./data/fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>%
separate(mon, into = c("year", "month", "day"), sep = "-")
```